<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SK4FiLM - Movie Search</title>
    <!-- Previous head content same as before -->
</head>

<body>
    <!-- Previous body content same as before -->

    <script>
        // Configuration
        const CONFIG = {
            BACKEND_URL: 'https://sk4film.koyeb.app',
            TIMEOUT: 15000
        };
        
        // FIXED: Search functionality with proper routing
        function searchMovie(query) {
            if (!query?.trim()) {
                alert('Please enter a search term');
                return;
            }
            
            console.log('üîç Redirecting to search page with query:', query);
            
            // Add loading state
            const searchBtn = document.querySelector('.search-btn');
            if (searchBtn) {
                const originalText = searchBtn.innerHTML;
                searchBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Searching...';
                searchBtn.disabled = true;
            }
            
            // FIXED: Multiple fallback methods for routing
            const encodedQuery = encodeURIComponent(query.trim());
            
            // Method 1: Direct path (most reliable)
            try {
                window.location.href = `search.html?query=${encodedQuery}`;
            } catch (error) {
                console.error('Method 1 failed:', error);
                
                // Method 2: Absolute URL
                try {
                    const baseURL = window.location.origin;
                    window.location.href = `${baseURL}/search.html?query=${encodedQuery}`;
                } catch (error2) {
                    console.error('Method 2 failed:', error2);
                    
                    // Method 3: Using URL constructor
                    try {
                        const url = new URL('/search.html', window.location.origin);
                        url.searchParams.set('query', query.trim());
                        window.location.href = url.toString();
                    } catch (error3) {
                        console.error('All methods failed:', error3);
                        alert('Unable to navigate to search page. Please try again.');
                        
                        // Reset button
                        if (searchBtn) {
                            searchBtn.innerHTML = originalText;
                            searchBtn.disabled = false;
                        }
                    }
                }
            }
        }
        
        // Rest of the JavaScript same as before
        // ... (previous utility functions, loadLatestPosters, etc.)
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ SK4FiLM Frontend Loading');
            console.log('üì° Backend API:', CONFIG.BACKEND_URL);
            
            // Load posters
            loadLatestPosters();
            
            // FIXED: Enhanced search form handler
            const searchForm = document.getElementById('searchForm');
            const searchInput = document.getElementById('searchInput');
            
            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const query = searchInput.value.trim();
                    
                    if (query) {
                        console.log('Form submitted with query:', query);
                        searchMovie(query);
                    } else {
                        searchInput.focus();
                        alert('Please enter a search term');
                    }
                });
            }
            
            // Add Enter key support
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const query = this.value.trim();
                        if (query) {
                            searchMovie(query);
                        }
                    }
                });
            }
        });
        
        console.log('%cüé¨ SK4FiLM - Ready with Fixed Routing', 'color: #ff0000; font-size: 16px; font-weight: bold;');
    </script>
</body>
</html>
